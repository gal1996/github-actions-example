name: add-label-on-pr-created

on:
  pull_request:
    types: [opened, synchronize]

jobs:
    add_label:
        runs-on: ubuntu-latest
        permissions:
          pull-requests: write
        steps:
          - name: checkout
            uses: actions/checkout@v3
            with:
              ref: '${{ github.event.pull_request.base.sha }}'
          - name: diff
            run: |
              git diff --diff-filter=AM --name-only \
                ${{ github.event.pull_request.base.sha }}.. >> ./updated
              echo "diff=$(cat ./updated)" >> "$GITHUB_OUTPUT"
          - name: echo
            run: |
              echo "diff: ${{ steps.diff.outputs.diff}})"
          - name: add_label
            run: gh pr edit ${{ github.event.number }} --add-label "enhancement"
            env:
              GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
              GH_REPO: ${{ github.repository }}

